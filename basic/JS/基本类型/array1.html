<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <!-- slice() 方法返回一个新的数组对象，这一对象是一个由 start 和 end 决定的原数组的浅拷贝（包括 start，不包括 end），其中 start 和 end 代表了数组元素的索引。原始数组不会被改变。 -->
    <!-- 如果索引是负数，则从数组末尾开始计算——如果 start/end < 0，则使用 start/end + array.length -->
    <!-- slice() 方法经常与 bind() 和 call() 一起使用，用于创建一个实用方法，将类数组对象转换为数组。 -->
    <script>
      // 调用 slice() 方法时，会将 this 对象作为第一个参数传入
      const slice = Function.prototype.call.bind(Array.prototype.slice);

      function list() {
        return slice(arguments);
      }

      const list1 = list(1, 2, 3); // [1, 2, 3]
      console.log(list1);

      // 如果源数组是稀疏数组，slice() 方法返回的数组也会是稀疏数组。
      console.log([1, 2, , 4, 5].slice(1, 4)); // [2, empty, 4]

      // 判断稀疏数组
      function isSparseArray(arr) {
        let count = 0;
        for (let i = 0; i < arr.length; i++) {
          if (Object.prototype.hasOwnProperty.call(arr, i)) {
            count++;
          }
        }
        return count < arr.length;
      }

      // 测试示例
      const sparseArray = new Array(5);
      sparseArray[2] = "value";
      console.log(isSparseArray(sparseArray)); // 输出: true

      const denseArray = [1, 2, 3];
      console.log(isSparseArray(denseArray)); // 输出: false

      // splice() 方法就地移除或者替换已存在的元素和/或添加新的元素。此方法会修改原数组。
      // 语法
      // splice(start)
      // splice(start, deleteCount)
      // splice(start, deleteCount, item1)
      // splice(start, deleteCount, item1, item2, /* …, */ itemN)
      // 返回值
      //   一个包含了删除的元素的数组。
      //   如果只移除一个元素，则返回一个元素的数组。
      //   如果没有删除任何元素，则返回一个空数组。

      // 负索引从数组末尾开始计算——如果 -buffer.length <= start < 0，使用 start + array.length

      // splice() 方法读取 this 的 length 属性。然后，它根据需要更新整数键属性和 length 属性。
      const arrayLike = {
        length: 3,
        unrelated: "foo",
        0: 5,
        2: 4,
      };
      console.log(Array.prototype.splice.call(arrayLike, 0, 1, 2, 3));
      // [ 5 ]
      console.log(arrayLike);
      // { '0': 2, '1': 3, '3': 4, length: 4, unrelated: 'foo' }
    </script>
  </body>
</html>
