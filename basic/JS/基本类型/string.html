<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script src="./escapeHTML.js"></script>
    <script>
      console.log(
        "String.fromCharCode(65, 66, 67): " + String.fromCharCode(65, 66, 67)
      );
      console.log(
        "String.fromCharCode(0xd83c, 0xdf03): " +
          String.fromCharCode(0xd83c, 0xdf03)
      );
      console.log(
        "String.fromCodePoint(0x1f303): " + String.fromCodePoint(0x1f303)
      );
      console.log(
        "String.fromCodePoint(0x1F600): " + String.fromCodePoint(0x1f600)
      ); // "ğŸ˜€"
      console.log(`simple string template: Hello\nWorld`);
      console.log("String.raw: " + String.raw`Hello\nWorld`);

      const translations = {
        en: {
          greeting: "Hello",
          farewell: "Goodbye",
        },
        es: {
          greeting: "Hola",
          farewell: "AdiÃ³s",
        },
        fr: {
          greeting: "Bonjour",
          farewell: "Au revoir",
        },
      };

      function i18n(strings, ...values) {
        const lang = values[0]; // è·å–è¯­è¨€ä»£ç 
        return strings.reduce((result, str, i) => {
          const key = str.trim();
          const translation = translations[lang][key] || key;
          return result + translation;
        }, "");
      }

      // ä½¿ç”¨ç¤ºä¾‹
      const lang = "es"; // å‡è®¾å½“å‰è¯­è¨€æ˜¯è¥¿ç­ç‰™è¯­
      const greeting = i18n`${lang} greeting`;
      const farewell = i18n`${lang} farewell`;

      console.log(`i18n ${lang}: ${greeting}`); // è¾“å‡ºï¼šHola
      console.log(`i18n ${lang}: ${farewell}`); // è¾“å‡ºï¼šAdiÃ³s

      // charAt() æ–¹æ³•æ€»æ˜¯å°†å­—ç¬¦ä¸²ä½œä¸º UTF-16 ç å…ƒåºåˆ—è¿›è¡Œç´¢å¼•ï¼Œå› æ­¤å®ƒå¯èƒ½ä¼šè¿”å›å­¤é¡¹ä»£ç†ã€‚
      // è¦è·å–ç»™å®šç´¢å¼•å¤„çš„å®Œæ•´ Unicode ç ä½ï¼Œè¯·ä½¿ç”¨ String.prototype.codePointAt() å’Œ String.fromCodePoint()ã€‚
      const sentence = "The quick brown fox jumps over the lazy dog.";
      const index = 4;
      console.log(
        `The character at index ${index} is ${sentence.charAt(index)}`
      );

      // charCodeAt() æ–¹æ³•æ€»æ˜¯å°†å­—ç¬¦ä¸²å½“ä½œ UTF-16 ç å…ƒåºåˆ—è¿›è¡Œç´¢å¼•ï¼Œå› æ­¤å®ƒå¯èƒ½è¿”å›å•ç‹¬ä»£ç†é¡¹ï¼ˆlone surrogateï¼‰ã€‚
      // å¦‚æœè¦è·å–ç»™å®šç´¢å¼•å¤„çš„å®Œæ•´ Unicode ç ä½ï¼Œè¯·ä½¿ç”¨ String.prototype.codePointAt() æ–¹æ³•ã€‚
      console.log(
        `Character code ${sentence.charCodeAt(
          index
        )} is equal to ${sentence.charAt(index)}`
      );
      // Expected output: "Character code 113 is equal to q"

      const icons = "ğŸ˜„ğŸ˜„";
      console.log(
        `The charCode at index 0 get by charCodeAt is ${icons.charCodeAt(0)}`
      );
      console.log(
        `The charCode at index 0 get by codePointAt is ${icons.codePointAt(0)}`
      );
      console.log(
        `The charCode at index 1 get by charCodeAt is ${icons.charCodeAt(1)}`
      );
      console.log(
        `The charCode at index 1 get by codePointAt is ${icons.codePointAt(1)}`
      );
      console.log(
        `The charCode at index 2 get by charCodeAt is ${icons.charCodeAt(2)}`
      );
      console.log(
        `The charCode at index 2 get by codePointAt is ${icons.codePointAt(2)}`
      );
      console.log(
        `The charCode at index 3 get by charCodeAt is ${icons.charCodeAt(3)}`
      );
      console.log(
        `The charCode at index 3 get by codePointAt is ${icons.codePointAt(3)}`
      );

      // startsWith endsWith åŒºåˆ†å¤§å°å†™
      const str = "To be, or not to be, that is the question.";
      console.log("str: " + str);
      console.log('str.startsWith("To be"): ' + str.startsWith("To be")); // true
      console.log('str.startsWith("to be"): ' + str.startsWith("to be")); // false
      console.log(
        'str.startsWith("not to be", 10): ' + str.startsWith("not to be", 10)
      ); // true
      console.log('str.endsWith("question."): ' + str.endsWith("question.")); // true
      console.log('str.endsWith("Question."): ' + str.endsWith("Question.")); // false
      console.log('str.endsWith("to be", 19): ' + str.endsWith("to be", 19)); // true
      console.log('str.includes("to be"): ' + str.includes("to be")); // true
      console.log('str.includes("to Be"): ' + str.includes("to Be")); // false
      console.log(
        'str.includes("to be number one"): ' + str.includes("to be number one")
      ); // true
      console.log(
        'str.includes("not to be", 10): ' + str.includes("not to be", 10)
      ); // true

      // indexof åŒºåˆ†å¤§å°å†™
      let count = 0;
      let position = str.indexOf("e");

      while (position !== -1) {
        count++;
        position = str.indexOf("e", position + 1);
      }

      console.log(`ther are ${count} e in the str`); // 4

      const greetings = "   Hello world!   ";

      console.log("greetings: " + greetings);
      console.log("greetings.trim(): " + greetings.trim());
      console.log("greetings.trimStart(): " + greetings.trimStart());
      console.log("greetings.trimEnd(): " + greetings.trimEnd());

      const mood = "Happy! ";
      console.log(`String.prototype.repeat: I feel ${mood.repeat(3)}`);

      function replacer(match, p1, p2, p3, offset, string) {
        // p1 æ˜¯éæ•°å­—ï¼Œp2 æ˜¯æ•°å­—ï¼Œä¸” p3 éå­—æ¯æ•°å­—
        return [p1, p2, p3].join(" - ");
      }
      const newString = "abc12345#$*%".replace(
        /([^\d]*)(\d*)([^\w]*)/,
        replacer
      );
      console.log(newString); // abc - 12345 - #$*%

      const re = /apples/gi;
      const stra = "Apples are round, and apples are juicy.";
      const newstr = stra.replace(re, "oranges");
      console.log(newstr); // oranges are round, and oranges are juicy.

      const res = /(\w+)\s(\w+)/;
      const strb = "Maria Cruz";
      const newstra = strb.replace(res, "$2, $1");
      console.log(newstra); // Cruz, Maria

      function styleHyphenFormat(propertyName) {
        function upperToHyphenLower(match, offset, string) {
          return (offset > 0 ? "-" : "") + match.toLowerCase();
        }
        return propertyName.replace(/[A-Z]/g, upperToHyphenLower);
      }
      console.log(styleHyphenFormat("borderTop")); // border-top

      function f2c(x) {
        function convert(str, p1, offset, s) {
          return `${((p1 - 32) * 5) / 9}C`;
        }
        const s = String(x);
        const test = /(-?\d+(?:\.\d*)?)F\b/g;
        return s.replace(test, convert);
      }

      const test = /(-?\d+(?:\.\d*)?)F\b/g;
      let str1 = "The temperature is 32F today.";
      let str2 = "It was -10.5F last night.";
      let str3 = "Water freezes at 0F.";
      let str4 = "The temperature is 100.0F.";

      console.log(str1.match(test)); // è¾“å‡º: ["32F"]
      console.log(str2.match(test)); // è¾“å‡º: ["-10.5F"]
      console.log(str3.match(test)); // è¾“å‡º: ["0F"]
      console.log(str4.match(test)); // è¾“å‡º: ["100.0F"]

      function addOffset(match, ...args) {
        const hasNamedGroups = typeof args.at(-1) === "object";
        const offset = hasNamedGroups ? args.at(-3) : args.at(-2);
        return `${match} (${offset}) `;
      }

      console.log("abcd".replace(/(bc)/, addOffset)); // "abc (1) d"
      console.log("abcd".replace(/(?<group>bc)/, addOffset)); // "abc (1) d"

      // ä¸ replace() ä¸åŒï¼Œè¯¥æ–¹æ³•å°†æ›¿æ¢æ‰€æœ‰åŒ¹é…çš„å­—ç¬¦ä¸²ï¼Œè€Œä¸ä»…ä»…æ˜¯ç¬¬ä¸€ä¸ªã€‚
      // å¦‚æœå­—ç¬¦ä¸²ä¸æ˜¯é™æ€å·²çŸ¥çš„ï¼Œé‚£ä¹ˆè¿™ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºè°ƒç”¨ RegExp() æ„é€ å‡½æ•°è€Œä¸è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦å¯èƒ½ä¼šæ„å¤–åœ°æ”¹å˜å®ƒçš„è¯­ä¹‰ã€‚
      function unsafeRedactName(text, name) {
        return text.replace(new RegExp(name, "g"), "[REDACTED]");
      }
      function safeRedactName(text, name) {
        return text.replaceAll(name, "[REDACTED]");
      }

      const report =
        "A hacker called ha.*er used special characters in their name to breach the system.";

      console.log(unsafeRedactName(report, "ha.*er")); // "A [REDACTED]s in their name to breach the system."
      console.log(safeRedactName(report, "ha.*er")); // "A hacker called [REDACTED] used special characters in their name to breach the system."

      // slice() æ–¹æ³•æå–å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶å°†å…¶ä½œä¸ºæ–°å­—ç¬¦ä¸²è¿”å›ï¼Œè€Œä¸ä¿®æ”¹åŸå§‹å­—ç¬¦ä¸²ã€‚
      const strSlice = "The quick brown fox jumps over the lazy dog.";

      console.log(strSlice.slice(31));
      // Expected output: "the lazy dog."

      console.log(strSlice.slice(4, 19));
      // Expected output: "quick brown fox"

      console.log(strSlice.slice(-4));
      // Expected output: "dog."

      console.log(strSlice.slice(-9, -5));
      // Expected output: "lazy"
      console.log(strSlice.slice(-9, 39));
      // Expected output: "lazy"
      console.log(strSlice.slice(35, -5));
      // Expected output: "lazy"

      // å…³äº String.prototype.split()
      // å½“ç©ºå­—ç¬¦ä¸²ï¼ˆ""ï¼‰è¢«ç”¨ä½œåˆ†éš”ç¬¦æ—¶ï¼Œå­—ç¬¦ä¸²ä¸æ˜¯ç”±ç”¨æˆ·æ„ŸçŸ¥çš„å­—ç¬¦ï¼ˆgrapheme clusterï¼‰æˆ– unicode å­—ç¬¦ï¼ˆç ä½ï¼‰åˆ†å‰²ï¼Œè€Œæ˜¯ç”± UTF-16 ä»£ç å•ä½åˆ†å‰²ã€‚è¿™ç ´åäº†ä»£ç†å¯¹
      // å¦‚æœ separator æ˜¯ä¸€ä¸ªåŒ¹é…ç©ºå­—ç¬¦ä¸²çš„æ­£åˆ™è¡¨è¾¾å¼ï¼ŒåŒ¹é…æ˜¯ç”± UTF-16 ç å…ƒï¼ˆcode unitï¼‰è¿˜æ˜¯ Unicode ç ä½ï¼ˆcode pointï¼‰åˆ†å‰²ï¼Œå–å†³äºæ˜¯å¦è®¾ç½®äº† u æ ‡å¿—ã€‚
      // å¦‚æœ separator æ˜¯åŒ…å«æ•è·æ‹¬å·çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œåˆ™æ¯æ¬¡ separator åŒ¹é…æ—¶ï¼Œæ•è·æ‹¬å·çš„ç»“æœï¼ˆåŒ…æ‹¬ä»»ä½• undefined çš„ç»“æœï¼‰å°†è¢«æ‹¼æ¥åˆ°è¾“å‡ºæ•°ç»„ä¸­ã€‚
      // æ­¤è¡Œä¸ºæ˜¯ç”±æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡çš„ Symbol.split æ–¹æ³•æŒ‡å®šçš„

      console.log("ğŸ˜„ğŸ˜„".split(/(?:)/)); // [ "\ud83d", "\ude04", "\ud83d", "\ude04" ]
      console.log("ğŸ˜„ğŸ˜„".split(/(?:)/u)); // [ "ğŸ˜„", "ğŸ˜„" ]

      function splitString(stringToSplit, separator) {
        const arrayOfStrings = stringToSplit.split(separator);

        console.log("åŸå§‹å­—ç¬¦ä¸²ä¸ºï¼š", stringToSplit);
        console.log("åˆ†éš”ç¬¦ä¸ºï¼š", separator);
        console.log(
          "åˆ†éš”åçš„æ•°ç»„æœ‰",
          arrayOfStrings.length,
          "ä¸ªå…ƒç´ ï¼š",
          arrayOfStrings.join(" / ")
        );
      }

      const tempestString = "Oh brave new world that has such people in it.";
      const monthString = "Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec";

      const space = " ";
      const comma = ",";

      splitString(tempestString, space);
      splitString(tempestString);
      splitString(monthString, comma);

      const names =
        "Harry Trump ;Fred Barney; Helen Rigby ; Bill Abel ;Chris Hand ";

      console.log(names);

      const re1 = /\s*(?:;|$)\s*/;
      const nameList = names.split(re1);

      console.log(nameList);

      let str11 = "hello ; world";
      let str21 = "hello;world";
      let str31 = "hello ;";
      let str41 = "hello";

      console.log(str11.split(re1)); // è¾“å‡º: ["hello", "world"]
      console.log(str21.split(re1)); // è¾“å‡º: ["hello", "world"]
      console.log(str31.split(re1)); // è¾“å‡º: ["hello", ""]
      console.log(str41.split(re1)); // è¾“å‡º: ["hello"]

      const myString = "Hello World. How are you doing?";
      const splits = myString.split(" ", 3);

      console.log(splits);

      // å¦‚æœ separator åŒ…å«æ•è·æ‹¬å· ( )ï¼Œåˆ™å…¶åŒ¹é…ç»“æœå°†ä¼šåŒ…å«åœ¨è¿”å›çš„æ•°ç»„ä¸­ã€‚

      const myString1 = "Hello 1 word. Sentence number 2.";
      const splits1 = myString1.split(/(\d)/);

      console.log(splits1);
      // [ "Hello ", "1", " word. Sentence number ", "2", "." ]

      // ä¸€ä¸ªåŒ…å« Symbol.split æ–¹æ³•çš„å¯¹è±¡å¯ä»¥ç”¨ä½œåˆ†å‰²å™¨ï¼Œå¯ä»¥è‡ªå®šä¹‰åˆ†å‰²è¡Œä¸ºã€‚
      const splitByNumber = {
        [Symbol.split](str) {
          let num = 1;
          let pos = 0;
          const result = [];
          while (pos < str.length) {
            const matchPos = str.indexOf(num, pos);
            if (matchPos === -1) {
              result.push(str.substring(pos));
              break;
            }
            result.push(str.substring(pos, matchPos));
            pos = matchPos + String(num).length;
            num++;
          }
          return result;
        },
      };

      const myString2 = "a1bc2c5d3e4f5asdf6sdf7asdf8asdf9asdf10asdf11fdsa";
      console.log(myString2.split(splitByNumber));

      // ä¸‹é¢çš„ç¤ºä¾‹ä½¿ç”¨ä¸€ä¸ªå†…éƒ¨çŠ¶æ€æ¥å¼ºåˆ¶æ‰§è¡ŒæŸäº›è¡Œä¸ºï¼Œå¹¶ç¡®ä¿äº§ç”Ÿä¸€ä¸ªâ€œæœ‰æ•ˆâ€çš„ç»“æœã€‚ 
      const DELIMITER = ";";

      // åˆ†å‰²å‘½ä»¤ï¼Œç§»é™¤ä»»ä½•ä¸åˆæ³•æˆ–ä¸éœ€è¦çš„å€¼
      const splitCommands = {
        [Symbol.split](str, lim) {
          const results = [];
          const state = {
            on: false,
            brightness: {
              current: 2,
              min: 1,
              max: 3,
            },
          };
          let pos = 0;
          let matchPos = str.indexOf(DELIMITER, pos);

          while (matchPos !== -1) {
            const subString = str.slice(pos, matchPos).trim();

            switch (subString) {
              case "light on":
                // å¦‚æœ `on` çŠ¶æ€å·²ç»ä¸º trueï¼Œä»€ä¹ˆéƒ½ä¸åšã€‚
                if (!state.on) {
                  state.on = true;
                  results.push(subString);
                }
                break;

              case "light off":
                // å¦‚æœ `on` çŠ¶æ€å·²ç»ä¸º falseï¼Œä»€ä¹ˆéƒ½ä¸åšã€‚
                if (state.on) {
                  state.on = false;
                  results.push(subString);
                }
                break;

              case "brightness up":
                // äº®åº¦æœ‰ä¸€ä¸ªæœ€å¤§å€¼æ£€æŸ¥
                if (state.brightness.current < state.brightness.max) {
                  state.brightness.current += 1;
                  results.push(subString);
                }
                break;

              case "brightness down":
                // äº®åº¦æœ‰ä¸€ä¸ªæœ€å°å€¼æ£€æŸ¥
                if (state.brightness.current > state.brightness.min) {
                  state.brightness.current -= 1;
                  results.push(subString);
                }
                break;
            }

            if (results.length === lim) {
              break;
            }

            pos = matchPos + DELIMITER.length;
            matchPos = str.indexOf(DELIMITER, pos);
          }

          // å¦‚æœåˆ°è¾¾åˆ†å‰²æé™ `lim`ï¼Œä¸è¦æ·»åŠ å‰©ä¸‹çš„å‘½ä»¤
          if (results.length < lim) {
            results.push(str.slice(pos).trim());
          }
          return results;
        },
      };

      const commands =
        "light on; brightness up; brightness up; brightness up; light on; brightness down; brightness down; light off";
      console.log(commands.split(splitCommands, 3)); // ["light on", "brightness up", "brightness down"]
    </script>
  </body>
</html>
